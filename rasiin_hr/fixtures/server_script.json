[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Submit",
  "event_frequency": "All",
  "modified": "2025-10-18 10:42:54.092522",
  "module": "Rasiin Hr",
  "name": "Salary Payments",
  "reference_doctype": "Salary Payments",
  "script": "account = []\r\npayable_account = frappe.db.get_value(\"Payroll Entry\", doc.payroll_entry, \"payroll_payable_account\")\r\ncost_center = frappe.db.get_value(\"Payroll Entry\", doc.payroll_entry, \"cost_center\")\r\n\r\nif doc.salary_payments_details:\r\n    # Debit account for total salary payment\r\n    account.append({\r\n        \"account\": doc.account,\r\n        \"credit_in_account_currency\": doc.total_payment,\r\n        \"cost_center\": cost_center\r\n        \r\n    })\r\n\r\n    # Credit payable accounts for each employee\r\n    for i in doc.salary_payments_details:\r\n        if i.payment>0:\r\n            account.append({\r\n                \"account\": payable_account,\r\n                \"party_type\": \"Employee\",\r\n                \"party\": i.employee,\r\n                \"party_name\": i.employee_name,\r\n                \"debit_in_account_currency\": i.payment,\r\n                \"cost_center\": cost_center\r\n            })\r\n\r\n    # Create and submit the Journal Entry\r\n    jou = frappe.get_doc({\r\n        \"doctype\": \"Journal Entry\",\r\n        \"voucher_type\": \"Journal Entry\",\r\n        \"posting_date\": doc.posting_date,\r\n        \"user_remark\": f\"Salary Payments from {doc.from_date} to {doc.to_date}\",\r\n        \"accounts\": account,\r\n        \"salary_payments\": doc.name\r\n    })\r\n    jou.insert()\r\n    jou.submit()\r\n\r\n    # Update paid_amount in salary slips\r\n    for i in doc.salary_payments_details:\r\n        salary_slip = frappe.get_doc(\"Salary Slip\", i.salary_slip)\r\n        salary_slip.paid_amount = float(salary_slip.paid_amount) + float(i.payment)\r\n        salary_slip.save()\r\n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Cancel",
  "event_frequency": "All",
  "modified": "2025-10-18 10:43:03.776694",
  "module": "Rasiin Hr",
  "name": "Cancel Salary Payments",
  "reference_doctype": "Salary Payments",
  "script": "if doc.salary_payments_details:\r\n    for i in doc.salary_payments_details:\r\n        salary_slip = frappe.get_doc(\"Salary Slip\", i.salary_slip)\r\n        salary_slip.paid_amount = float(salary_slip.paid_amount) - float(i.payment)\r\n        salary_slip.save()\r\nif doc.docstatus ==2:\r\n    frappe.db.set_value(\"Salary Payments\", doc.name, \"payroll_entry\", \"\")",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Cancel",
  "event_frequency": "All",
  "modified": "2025-10-18 10:43:38.720689",
  "module": "Rasiin Hr",
  "name": "Cancel Salary Payment",
  "reference_doctype": "Journal Entry",
  "script": "if doc.salary_payments:\r\n    salary_payment_doc = frappe.get_doc(\"Salary Payments\", doc.salary_payments)\r\n    salary_payment_doc.cancel()",
  "script_type": "DocType Event"
 }
]